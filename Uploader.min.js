/*! (c) 2015 Lance Miller (MIT) */
!function(e,t){if("function"==typeof define&&define.amd)define("Private",["exports","module"],t);else if("undefined"!=typeof exports&&"undefined"!=typeof module)t(exports,module);else{var n={exports:{}};t(n.exports,n),e.Private=n.exports}}(this,function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=[],i=[],l=function(){function e(){n(this,e)}return r(e,[{key:"set",value:function(e,t){var n=o.indexOf(e);0>=n&&(n=o.push(e)-1),i[n]=t}},{key:"get",value:function(e){return i[o.indexOf(e)]}}]),e}();t.exports=l}),function(e,t){if("function"==typeof define&&define.amd)define("Uploader",["exports","module","./Private"],t);else if("undefined"!=typeof exports&&"undefined"!=typeof module)t(exports,module,require("./Private"));else{var n={exports:{}};t(n.exports,n,e.Private),e.Uploader=n.exports}}(this,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n in t)e[n]=t[n];return e}function l(e){if(e instanceof HTMLElement)e=[e];else if("string"==typeof e&&""!==e)e=document.querySelectorAll(e);else if(Array.isArray(e)){var t=[];e.forEach(function(e){t.concat(l(e))}),e=t}else e||(e=[document.createElement("button")]);return e}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=r(n);delete window.Private;var f=new a["default"],s=new a["default"],c={allowMultiple:!0,singleRequest:!0,accept:null,uploadURL:"/",fieldName:"file[]",progressBar:null,beforeFileSelect:function(e){},onFileSelect:function(e,t){},beforeUpload:function(e){},onProgress:function(e,t){},afterUpload:function(e){},onSuccess:function(e,t,n){},onError:function(e){}},d=function(){function e(t,n){o(this,e),t=l(t),s.set(this,t),n=i(c,n||{}),n.progressBar&&(n.progressBar=l(n.progressBar));var r=document.createElement("input");f.set(this,r),r.style.visibility="hidden",r.style.position="fixed",r.style.left="-99999%",r.style.top=r.style.left,r.style.width="1px",r.style.height=r.style.width,document.body.appendChild(r),r.setAttribute("type","file"),n.allowMultiple&&r.setAttribute("multiple","multiple"),null!==n.accept&&r.setAttribute("accept",n.accept),[].forEach.call(t,function(e){e.addEventListener("click",function(e){e.preventDefault(),n.beforeFileSelect(e)!==!1&&r.click()})}),r.addEventListener("change",function(e){var t=this;n.onFileSelect(this.files,e)!==!1&&[].forEach.call(n.singleRequest?[null]:this.files,function(e){var r=new FormData,o=new XMLHttpRequest;if(null===e)for(var i in t.files)r.append(n.fieldName,t.files[i]);else r.append(n.fieldName,e);o.upload.addEventListener("progress",function(t){var r=null;t.lengthComputable&&(r=Math.round(100*t.loaded/t.total*100)/100,n.progressBar&&[].forEach.call(n.progressBar,function(e){e.style.width=Math.round(r)+"%"})),t.currentFile=e,n.onProgress(r,t)}),o.upload.addEventListener("load",function(e){n.afterUpload(o)}),o.addEventListener("loadend",function(t){t.currentFile=e,n.onSuccess(t.target.response,t.target,t)}),o.upload.addEventListener("error",function(e){n.onError(e)}),o.open("POST",n.uploadURL),o.setRequestHeader("Cache-Control","no-cache"),n.beforeUpload(o,r)!==!1&&o.send(r)})})}return u(e,[{key:"element",get:function(){return s.get(this)}}],[{key:"DEFAULT_OPTS",get:function(){return c}}]),e}();t.exports=d});