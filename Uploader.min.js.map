{"version":3,"sources":["Uploader.min.js","Private.js","Uploader.js"],"names":["global","factory","define","amd","exports","module","mod","Private","this","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","keys","vals","value","val","index","indexOf","push","require","Uploader","_Private","_interopRequireDefault","obj","__esModule","default","_extend","obj1","obj2","_convertElement","elem","HTMLElement","document","querySelectorAll","createElement","_Private2","fileElement","DEFAULT_OPTS","allowMultiple","accept","uploadURL","fieldName","progressBar","beforeFileSelect","e","console","log","onFileSelect","files","beforeUpload","xhr","onProgress","percent","afterUpload","onError","opts","input","setAttribute","set","forEach","call","el","addEventListener","preventDefault","click","data","FormData","req","XMLHttpRequest","append","upload","lengthComputable","Math","round","loaded","total","bar","style","width","open","setRequestHeader","send","get"],"mappings":"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","file":"Uploader.min.js","sourcesContent":[null,"let keys = [],\n\tvals = [];\n\nexport default class Private {\n\tset(key, val) {\n\t\tvar index = keys.indexOf(key);\n\n\t\tif (index <= 0) {\n\t\t\tindex = keys.push(key) - 1;\n\t\t}\n\n\t\tvals[index] = val;\n\t}\n\n\tget(key) {\n\t\treturn vals[keys.indexOf(key)];\n\t}\n}\n","import Private from './Private';\n\nlet fileElement = new Private(),\n\telement = new Private(),\n\tDEFAULT_OPTS = {\n\t\tallowMultiple: true,\n\t\taccept: null,\n\t\tuploadURL: '/',\n\t\tfieldName: 'file[]',\n\t\tprogressBar: null,\n\t\tbeforeFileSelect: (e) => {\n\t\t\tconsole.log('beforeFileSelect');\n\t\t},\n\t\tonFileSelect: (e, files) => {\n\t\t\tconsole.log('onFileSelect', e, files);\n\t\t},\n\t\tbeforeUpload: (xhr) => {\n\t\t\tconsole.log('beforeUpload', xhr);\n\t\t},\n\t\tonProgress: (e, percent) => {\n\t\t\tconsole.log('onProgress', e, percent);\n\t\t},\n\t\tafterUpload: (e) => {\n\t\t\tconsole.log('afterUpload', e);\n\t\t},\n\t\tonError: (e) => {\n\n\t\t}\n\t};\n\nfunction _extend(obj1, obj2) {\n\tfor (var key in obj2) {\n\t\tobj1[key] = obj2[key];\n\t}\n\treturn obj1;\n}\n\nfunction _convertElement(elem) {\n\tif(elem instanceof HTMLElement) {\n\t\telem = [elem];\n\t} else if (typeof elem === 'string' && elem !== '') {\n\t\telem = document.querySelectorAll(elem);\n\t} else {\n\t\telem = [document.createElement('a')];\n\t}\n\n\treturn elem;\n}\n\nexport default class Uploader {\n\n\tstatic get DEFAULT_OPTS() {\n\t\treturn DEFAULT_OPTS;\n\t}\n\n\tconstructor(elem, opts) {\n\t\telem = _convertElement(elem);\n\t\topts = _extend(DEFAULT_OPTS, opts);\n\n\t\tif (opts.progressBar) {\n\t\t\topts.progressBar = _convertElement(opts.progressBar);\n\t\t}\n\n\t\tvar input = document.createElement('input');\n\t\tinput.setAttribute('type', 'file');\n\n\t\tif (opts.allowMultiple) {\n\t\t\tinput.setAttribute('multiple', 'multiple');\n\t\t}\n\n\t\tif (opts.accept !== null) {\n\t\t\tinput.setAttribute('accept', opts.accept);\n\t\t}\n\n\t\tfileElement.set(this, input);\n\n\n\t\t[].forEach.call(elem, (el) => {\n\t\t\tel.addEventListener('click', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tif (opts.beforeFileSelect(e) !== false) {\n\t\t\t\t\tinput.click();\n\t\t\t\t}\n\t\t\t})\n\t\t});\n\n\t\tinput.addEventListener('change', function(e) {\n\t\t\topts.onFileSelect(e, this.files);\n\n\t\t\tvar data = new FormData(),\n\t\t\t\treq = new XMLHttpRequest();\n\n\t\t\tfor (let i in this.files) {\n\t\t\t\tdata.append(opts.fieldName, this.files[i]);\n\t\t\t}\n\n\t\t\treq.upload.addEventListener('progress', (e) => {\n\t\t\t\tvar percent = null;\n\t\t\t\tif (e.lengthComputable) {\n\t\t\t\t\tpercent = Math.round(((e.loaded * 100) / e.total) * 100) / 100;\n\t\t\t\t\tif (opts.progressBar) {\n\t\t\t\t\t\t[].forEach.call(opts.progressBar, (bar) => {\n\t\t\t\t\t\t\tbar.style.width = Math.round(percent)+'%';\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\topts.onProgress(e, percent);\n\t\t\t});\n\n\t\t\treq.upload.addEventListener('load', (e) => {\n\t\t\t\topts.afterUpload(e);\n\t\t\t});\n\n\t\t\treq.upload.addEventListener('error', (e) => {\n\t\t\t\topts.onError(e);\n\t\t\t});\n\n\t\t\treq.open('POST', opts.uploadURL);\n\t\t\treq.setRequestHeader('Cache-Control', 'no-cache');\n\t\t\tif (opts.beforeUpload(req) !== false) {\n\t\t\t\treq.send(data);\n\t\t\t}\n\t\t});\n\t}\n}\n"],"sourceRoot":"/source/"}